/**
 * 简化的docx库替代方案
 * 提供基本的Word文档生成功能
 */
(function() {
  'use strict';
  
  // 创建简化的docx对象
  const docx = {
    Document: function(options) {
      this.sections = [];
      this.options = options || {};
      return this;
    },
    
    Paragraph: function(options) {
      this.text = '';
      this.options = options || {};
      
      if (options && options.children) {
        this.text = options.children.map(child => {
          if (typeof child === 'string') return child;
          if (child && child.text) return child.text;
          return '';
        }).join('');
      }
      
      return this;
    },
    
    TextRun: function(options) {
      this.text = options && options.text ? options.text : '';
      this.options = options || {};
      return this;
    },
    
    Packer: {
      toBlob: function(doc) {
        return new Promise((resolve, reject) => {
          try {
            // 创建一个简单的文本内容
            let content = '';
            if (doc && doc.sections) {
              content = doc.sections.map(section => {
                if (section && section.children) {
                  return section.children.map(child => {
                    if (child && child.text) return child.text;
                    return '';
                  }).join('\n');
                }
                return '';
              }).join('\n\n');
            }
            
            // 创建一个简单的文本blob
            const blob = new Blob([content], { type: 'text/plain' });
            resolve(blob);
          } catch (error) {
            reject(new Error('文档生成失败: ' + error.message));
          }
        });
      }
    },
    
    // 其他常用组件的占位符
    HeadingLevel: {
      HEADING_1: 1,
      HEADING_2: 2,
      HEADING_3: 3
    },
    
    AlignmentType: {
      CENTER: 'center',
      LEFT: 'left',
      RIGHT: 'right'
    }
  };
  
  // 导出到全局
  if (typeof window !== 'undefined') {
    window.docx = docx;
  }
  
  // 支持模块化导出
  if (typeof module !== 'undefined' && module.exports) {
    module.exports = docx;
  }
  
  console.log('简化版docx库已加载');
})();